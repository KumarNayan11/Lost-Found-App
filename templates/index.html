{% extends "base.html" %}

{% block content %}
    <h1>Lost and Found Items</h1>

    <div class="action-bar">
        <a href="{{ url_for('add_item') }}">Add New Item</a>

        <form method="post" action="{{ url_for('clear_items') }}"
              onsubmit="return confirm('Are you sure you want to delete all items?');">
            <button type="submit">Clear All</button>
        </form>
    </div>

    <form class="search-form" method="get" action="{{ url_for('index') }}">
        <input type="text" name="search" value="{{ search }}" placeholder="Search by name, description, or contact">
        <button type="submit" class="search-btn">Search</button>
        {% if search %}
        <a href="{{ url_for('index') }}">Clear</a>
        {% endif %}
    </form>

    <h2>Lost Items</h2>
<div class="form-container">
    <ul>
        {% set lost_items = items | selectattr(4, 'equalto', 'Lost') | list %}
        {% if lost_items %}
            {% for item in lost_items %}
            <li class="lost">
                <strong>{{ item[4] }}:</strong> {{ item[1] }} - {{ item[2] }} (Contact: {{ item[3] }})<br>
                <small>Added on: {{ item[5] }}</small>
                <form method="post" action="{{ url_for('mark_found', item_id=item[0]) }}" style="display:inline; margin-left: 20px;">
                    <button type="submit">Mark as Found</button>
                </form>
            </li>
            {% endfor %}
        {% else %}
            <li class="empty">No current lost items found.</li>
        {% endif %}
    </ul>
</div>


    <h2>Found Items (Past Entries)</h2>
<div class="form-container">
    <ul>
        {% set found_items = items | selectattr(4, 'equalto', 'Found') | list %}
        {% if found_items %}
            {% for item in found_items %}
            <li class="found">
                <strong>{{ item[4] }}:</strong> {{ item[1] }} - {{ item[2] }} (Contact: {{ item[3] }})<br>
                {% if item[6] %}
                <small>Found on: {{ item[6] }}</small>
                {% else %}
                <small>Found date not recorded</small>
                {% endif %}
            </li>
            {% endfor %}
        {% else %}
            <li class="empty">No past found items.</li>
        {% endif %}
    </ul>
</div>

{% endblock %}
